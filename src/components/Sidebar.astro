---
// Sidebar.astro
// biome-ignore lint/correctness/noUnusedVariables: This component is used in the layout
const { currentPage } = Astro.props;
---

<!-- Responsive sidebar with hamburger menu -->
<>
  <!-- Hamburger for mobile -->
  <button id="sidebar-toggle" class="md:hidden fixed top-4 left-4 z-50 bg-black bg-opacity-80 text-primary p-2 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-black" aria-label="Open menu">
    <svg id="sidebar-hamburger" class="h-7 w-7 block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
    </svg>
    <svg id="sidebar-close-x" class="h-7 w-7 hidden" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
    </svg>
  </button>
  <!-- Mobile overlay -->
  <div id="sidebar-overlay" class="fixed left-0 right-0 top-0 bottom-0 bg-black bg-opacity-60 z-40 hidden md:hidden"></div>
  <!-- Sidebar -->
  <aside id="sidebar" class="fixed left-0 top-16 h-[calc(100vh-4rem)] w-64 bg-black text-white shadow-lg z-50 transform -translate-x-full md:relative md:top-auto md:w-full md:translate-x-0 md:block transition-transform duration-200 md:h-auto md:z-30 md:pt-4" tabindex="-1" aria-label="Main navigation">
    <div class="flex flex-col h-full p-6 gap-6 relative overflow-y-auto">
      <nav aria-label="Main navigation">
        <ul class="flex flex-col gap-4 text-lg font-medium list-none p-0 m-0">
          <li>
            <a href="/" class={`flex items-center gap-3 hover:text-primary transition-colors ${currentPage === 'home' ? 'text-primary font-bold' : ''}`} aria-current={currentPage === 'home' ? 'page' : undefined}>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 21v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21m0 0h4.5V3.545M12.75 21h7.5V10.75M2.25 21h1.5m18 0h-18M2.25 9l4.5-1.636M18.75 3l-1.5.545m0 6.205 3 1m1.5.5-1.5-.5M6.75 7.364V3h-3v18m3-13.636 10.5-3.819" />
              </svg>
              Home
            </a>
          </li>
          <li>
            <a href="/documentation" class={`flex items-center gap-3 hover:text-primary transition-colors ${currentPage === 'documentation' ? 'text-primary font-bold' : ''}`} aria-current={currentPage === 'documentation' ? 'page' : undefined}>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                <path fill-rule="evenodd" d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z" clip-rule="evenodd" />
                <path d="M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z" />
              </svg>
              Documentation
            </a>
          </li>
          <li>
            <a href="/cdn" class={`flex items-center gap-3 hover:text-primary transition-colors ${currentPage === 'cdn' ? 'text-primary font-bold' : ''}`} aria-current={currentPage === 'cdn' ? 'page' : undefined}>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25h13.5m-13.5 0a3 3 0 0 1-3-3m3 3a3 3 0 1 0 0 6h13.5a3 3 0 1 0 0-6m-16.5-3a3 3 0 0 1 3-3h13.5a3 3 0 0 1 3 3m-19.5 0a4.5 4.5 0 0 1 .9-2.7L5.737 5.1a3.375 3.375 0 0 1 2.7-1.35h7.126c1.062 0 2.062.5 2.7 1.35l2.587 3.45a4.5 4.5 0 0 1 .9 2.7m0 0a3 3 0 0 1-3 3m0 3h.008v.008h-.008v-.008Zm0-6h.008v.008h-.008v-.008Zm-3 6h.008v.008h-.008v-.008Zm0-6h.008v.008h-.008v-.008Z" />
              </svg>
              CDN Demo
            </a>
          </li>
          <li>
            <a href="/m3u" class={`flex items-center gap-3 hover:text-primary transition-colors ${currentPage === 'm3u' ? 'text-primary font-bold' : ''}`} aria-current={currentPage === 'm3u' ? 'page' : undefined}>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                <path fill-rule="evenodd" d="M19.952 1.651a.75.75 0 0 1 .298.599V16.303a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.403-4.909l2.311-.66a1.5 1.5 0 0 0 1.088-1.442V6.994l-9 2.572v9.737a3 3 0 0 1-2.176 2.884l-1.32.377a2.553 2.553 0 1 1-1.402-4.909l2.31-.66a1.5 1.5 0 0 0 1.088-1.442V5.25a.75.75 0 0 1 .544-.721l10.5-3a.75.75 0 0 1 .658.122Z" clip-rule="evenodd" />
              </svg>
              M3U Demo
            </a>
          </li>
          <li>
            <a href="https://github.com/davland7/rplayer" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 hover:text-primary transition-colors">
              <svg viewBox="0 0 98 96" class="h-6 w-6" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="#fff"/>
              </svg>
              GitHub
            </a>
          </li>
        </ul>
      </nav>
      <div class="flex-1"></div>
    </div>
  </aside>
</>

<script is:inline>
  document.addEventListener('DOMContentLoaded', function() {
    // Common elements
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebar-overlay');
    const toggle = document.getElementById('sidebar-toggle');
    const hamburger = document.getElementById('sidebar-hamburger');
    const closeX = document.getElementById('sidebar-close-x');

    if (!sidebar || !overlay || !toggle || !hamburger || !closeX) return;

    // Functions for mobile menu management
    function closeSidebar() {
      sidebar.classList.add('-translate-x-full');
      overlay.classList.add('hidden');
      hamburger.classList.remove('hidden');
      closeX.classList.add('hidden');
      toggle.focus();
    }

    function openSidebar() {
      sidebar.classList.remove('-translate-x-full');
      overlay.classList.remove('hidden');
      hamburger.classList.add('hidden');
      closeX.classList.remove('hidden');
      toggle.focus();
    }

    // Mobile menu configuration
    toggle.onclick = () => {
      if (sidebar.classList.contains('-translate-x-full')) {
        openSidebar();
      } else {
        closeSidebar();
      }
    };

    overlay.onclick = closeSidebar;

    // Close menu on navigation
    sidebar.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', closeSidebar);
    });

    // Close with ESC key
    document.addEventListener('keydown', (e) => {
      if (!sidebar.classList.contains('-translate-x-full') && (e.key === 'Escape' || e.key === 'Esc')) {
        closeSidebar();
      }
    });
  });
</script>
