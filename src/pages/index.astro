---
// biome-ignore lint/correctness/noUnusedImports: Used in Astro template
import Layout from "../layouts/Layout.astro";
// biome-ignore lint/correctness/noUnusedImports: Used in Astro template
import CookieConsent from "../components/CookieConsent/CookieConsent.js";
// biome-ignore lint/correctness/noUnusedImports: Used in Astro template
import MarkdownSection from "../components/MarkdownSection.astro";
// biome-ignore lint/correctness/noUnusedImports: Used in Astro template
import RadioSearch from "../components/RadioSearch/index.js";
// biome-ignore lint/correctness/noUnusedImports: Used in Astro template
import { Content as HomeContent } from "../content/home.md";
import type { RadioStation, GenreCountryItem } from "../api/radio-browser.js";
import { fetchPopularGenresAndCountriesSorted, SearchType } from "../api/radio-browser.js";
import "flag-icons/css/flag-icons.min.css";

// biome-ignore lint/correctness/noUnusedVariables: Used in Astro template
const initialTag = "favorites";
// biome-ignore lint/correctness/noUnusedVariables: Used in Astro template
const preloadedStations: RadioStation[] = [];
const preloadedGenresCountries = await fetchPopularGenresAndCountriesSorted();

const SAVED_TAG: GenreCountryItem = { name: "Favorites", slug: "favorites", type: SearchType.Tag };
let genresCountries = preloadedGenresCountries || [];
if (!genresCountries.some((tag) => tag.slug === "favorites")) {
	genresCountries = [SAVED_TAG, ...genresCountries];
}
---

<Layout
  title="RPlayer - Audio Player for Streaming Radio in action"
  description="RPlayer is a lightweight audio player for streaming radio that supports HLS streams, MP3, AAC and more formats."
  currentPage="home"
>
  <MarkdownSection>
    <HomeContent />
  </MarkdownSection>

  <CookieConsent client:only="react" />

  <h2 class="text-2xl font-bold text-white"><span class="font-semibold">R<span class="text-primary">Player</span></span> in action</h2>
  <RadioSearch
    client:only="react"
    initialTag={initialTag}
    initialVisibleCount={10}
    preloadedGenresCountries={genresCountries}
    preloadedStations={preloadedStations}
  />
</Layout>
